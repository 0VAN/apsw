<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content="HTML Tidy for Linux (vers 6 November 2007), see www.w3.org" />

  <title>APSW - Another Python SQLite Wrapper</title>
  <style type="text/css">
/*<![CDATA[*/
  body { 
  font-family: verdana, arial, helvetica, sans-serif;
  margin: 20px;
  background-color: #ffcc99;
  padding: 7px;
  }
  .pynumber    { color: #0080C0;}
  .pyoperator  { color: #0000C0;}
  .pystring    { color: #004080;}
  .pycomment   { color: #008000;}
  .pyname      { color: #000000;}
  .pyerror     { color: #FF8080;}
  .pykeyword   { color: #C00000;}
  .pytext      { color: #000000;}
  .pyoutput    { color: #0000FF;}

  }
  /*]]>*/
  </style>
</head>

<body>
  <h1 class="notoc">APSW - Another Python SQLite Wrapper</h1>

  <h1><a name="APIReference" id="APIReference">API Reference</a></h1>

  <p>Everything you can do from the <a href="http://www.sqlite.org/c3ref/intro.html">SQLite 3 C API</a> you can do from
  Python. The documentation below notes which C API functions are called where you can get further details on what
  happens. The only functionality not implemented is <a href="http://www.sqlite.org/c3ref/vfs.html">VFS</a> because it
  is being changed for SQLite 3.6. Additionally <a href="http://sqlite.org/c3ref/profile.html">sqlite3_trace</a> is not
  wrapped but instead <a href="#tracers">tracers</a> are provided that have more functionality.</p>

  <p>Some functions are marked experimental in the SQLite API. These have also been made available, but as the SQLite
  documentation notes these functions may change form or disappear in future versions of SQLite. You can exclude these
  functions by commenting out the relevant line in the <code>setup.py</code> when building aspw.</p>

  <p>Various methods create functions, collations and set various hooks and handlers. To remove the relevant
  function/collation/hook/handler, pass in None as the callable method.</p>

  <h2><a name="module-methods" id="module-methods">Module methods</a></h2>

  <dl>
    <dt><strong>sqlitelibversion()</strong></dt>

    <dd>
      <p>Returns the version of the SQLite library as a string. This function calls <a href=
      "http://sqlite.org/c3ref/libversion.html">sqlite3_libversion</a>.</p>
    </dd>

    <dt><strong>apswversion()</strong></dt>

    <dd>
      <p>Returns the version of the APSW module.</p>
    </dd>

    <dt><strong>enablesharedcache(boolean)</strong></dt>

    <dd>
      <p>Calls <a href="http://sqlite.org/c3ref/enable_shared_cache.html">sqlite3_enable_shared_cache</a>. This sets
      the <a href="http://www.sqlite.org/sharedcache.html">shared cache mode</a> which was introduced in SQLite
      3.3.</p>
    </dd>

    <dt><strong>createmodule("modulename", module_object)</strong></dt>

    <dd>
      <p>Registers a virtual table. See <a href="#VirtualTables">virtual tables</a> for more details.</p>
    </dd>

    <dt><strong>initialize()</strong> &amp; <strong>shutdown</strong></dt>

    <dd>
      <p>Calls the <a href="http://sqlite.org/c3ref/initialize.html">sqlite3_initialize/sqlite3_shutdown</a> functions.
      There is no need to manually call these functions. Note that it is a really bad idea to call shutdown unless you
      are absolutely sure all connections and cursors have been closed, deleted and garbage collected.</p>
    </dd>

    <dt><strong>randomness(bytes)</strong></dt>

    <dd>
      <p>Calls <a href="http://sqlite.org/c3ref/randomness.html">sqlite3_randomness</a> to obtain <i>bytes</i> of
      random data.</p>
    </dd>

    <dt><strong>config(op [,args])</strong></dt>

    <dd>
      <p>Calls the <a href="http://sqlite.org/c3ref/config.html">sqlite3_config</a> function. Only the options
      SQLITE_CONFIG_SINGLETHREAD, SQLITE_CONFIG_MULTITHREAD, SQLITE_CONFIG_SERIALIZED and SQLITE_CONFIG_MEMSTATUS are
      supported.</p>
    </dd>

    <dt><strong>memoryused()</strong></dt>

    <dd>
      <p>Returns the amount of memory SQLite is currently using by calling <a href=
      "http://sqlite.org/c3ref/memory_highwater.html">sqlite3_memory_used</a>.</p>
    </dd>

    <dt><strong>memoryhighwater(reset=False)</strong></dt>

    <dd>
      <p>Returns the most amount of memory SQLite has used by calling <a href=
      "http://sqlite.org/c3ref/memory_highwater.html">sqlite3_memory_highwater</a>. If <code>reset</code> is not False
      then the counter is reset.</p>
    </dd>

    <dt><strong>softheaplimit(bytes)</strong></dt>

    <dd>
      <p>Calls <a href="http://sqlite.org/c3ref/soft_heap_limit.html">sqlite3_soft_heap_limit</a> requesting a soft
      upper bounds on the amount of memory SQLite uses.</p>
    </dd>

    <dt><strong>releasememory(bytes)</strong></dt>

    <dd>
      <p>Calls <a href="http://sqlite.org/c3ref/release_memory.html">sqlite3_release_memory</a> requesting SQLite free
      up to <i>bytes</i> bytes of memory. Returns how much was actually freed.</p>
    </dd>

    <dt><strong>status(op, reset=False)</strong></dt>

    <dd>
      <p>Returns a tuple of current and highwater values for various SQLite counters by calling <a href=
      "http://sqlite.org/c3ref/status.html">sqlite3_status</a>. If <code>reset</code> is not False then the highwater
      is reset to the current value.</p>
    </dd>

    <dt><a name="exceptionfor" id="exceptionfor"><strong>exceptionfor(code)</strong></a></dt>

    <dd>
      <p>Returns an exception instance corresponding to a SQLite error code, in particular intended for mapping
      <a href="http://www.sqlite.org/cvstrac/wiki?p=ExtendedResultCodes">extended result codes</a> to <a href=
      "#Exceptions">exceptions</a>. In addition to picking the right exception class, it also sets the
      <tt>extendedresult</tt> attribute on the instance. This function is useful for returning specific errors in your
      VFS implementation. An example usage is:</p>

      <blockquote>
        <pre>
 raise apsw.exceptionfor(SQLITE_IOERR_SHORT_READ)
</pre>
      </blockquote>
    </dd>

    <dt><strong>vfsnames()</strong></dt>

    <dd>
      <p>Returns a list of the names of the installed vfs modules, with the default being first. You can use this to
      confirm that your vfs is installed. It is also useful if you want to install your vfs as the default and need the
      name of the previous default to inherit from.</p>
    </dd>
  </dl>

  <h2><a name="Module_variables" id="Module_variables">Module variables</a></h2>

  <dl>
    <dt><strong>connection_hooks</strong></dt>

    <dd>
      <p>The purpose of the hooks is to allow the easy registration of functions, virtual tables or similar items with
      each Connection as it is created. The default value is an empty list. Whenever a Connection is created, each item
      in <code>apsw.connection_hooks</code> is invoked with a single parameter being the new Connection object. If the
      hook raises an exception then the creation of the Connection fails.</p>
    </dd>
  </dl>

  <h2><a name="Module_constants" id="Module_constants">Module constants</a></h2>

  <p>Note that the same values can be used in different contexts. For example SQLITE_OK and SQLITE_CREATE_INDEX both
  have a value of zero. For each group of constants there is also a mapping (dict) available that you can supply a
  string to and get the corresponding numeric value, or supply a numeric value and get the corresponding string. These
  can help improve diagnostics/logging, calling other modules etc. For example</p>

  <blockquote>
    <pre>
apsw.mapping_authorizer_function["SQLITE_READ"]=20
apsw.mapping_authorizer_function[20]="SQLITE_READ"

</pre>
  </blockquote>

  <dl>
    <dt><strong>SQLITE_VERSION_NUMBER</strong></dt>

    <dd>
      <p>This is the version of the SQLite library from the header file <tt>sqlite3.h</tt> at apsw compile time. It is
      expressed as an integer (eg 3003010 for SQLite 3.3.10).</p>
    </dd>

    <dt><strong><a href="http://sqlite.org/c3ref/c_deny.html">SQLITE_OK, SQLITE_DENY, SQLITE_IGNORE</a></strong></dt>

    <dd>
      <p>These values are returned from authorizer functions. Mapping is
      <code>apsw.mapping_authorizer_return</code></p>
    </dd>

    <dt><a href="http://sqlite.org/c3ref/c_alter_table.html"><strong>SQLITE_CREATE_INDEX, SQLITE_CREATE_TABLE</strong>
    and 30 others</a></dt>

    <dd>
      <p>The values are passed to authorizer functions. You can see a complete list in the <a href=
      "http://sqlite.org/c3ref/set_authorizer.html">sqlite3_set_authorizer documentation</a>. Mapping is
      <code>apsw.mapping_authorizer_function</code></p>
    </dd>

    <dt><strong>SQLITE_INDEX_CONSTRAINT_EQ, SQLITE_INDEX_CONSTRAINT_GT</strong> and 4 others</dt>

    <dd>
      <p>These values are passed to the BestIndex method of <a href="#VirtualTables">virtual tables</a>. Mapping is
      <code>apsw.mapping_bestindex_constraints</code></p>
    </dd>

    <dt><a href="http://sqlite.org/c3ref/c_ioerr_blocked.html"><strong>SQLITE_IOERR_READ, SQLITE_IOERR_FSYNC</strong>
    and 7 others</a></dt>

    <dd>
      <p>These are <a href="http://sqlite.org/c3ref/c_ioerr_blocked.html">extended result codes</a> which are provided
      in <a href="#Exceptions">exceptions</a>. Mapping is <code>apsw.mapping_extended_result_codes</code></p>
    </dd>

    <dt><a href="http://sqlite.org/c3ref/c_abort.html"><strong>SQLITE_OK, SQLITE_ERROR, SQLITE_PERM</strong> and 22
    others</a></dt>

    <dd>
      <p>These are <a href="http://sqlite.org/c3ref/c_abort.html">SQLite result codes</a> which are provided in
      <a href="#Exceptions">exceptions</a>. Mapping is <code>apsw.mapping_result_codes</code></p>
    </dd>

    <dt><a href="http://sqlite.org/c3ref/c_open_create.html"><strong>SQLITE_OPEN_READONLY, SQLITE_OPEN_CREATE</strong>
    and 10 others</a></dt>

    <dd>
      <p>These are used for <a href="http://sqlite.org/c3ref/open.html">opening the database</a> as well as the VFS.
      Mapping is <code>apsw.mapping_open_flags</code></p>
    </dd>

    <dt><a href="http://www.sqlite.org/c3ref/c_limit_attached.html"><strong>SQLITE_LIMIT_LENGTH,
    SQLITE_LIMIT_SQL_LENGTH</strong> and 8 others</a>. Mapping is <code>apsw.mapping_limits</code></dt>

    <dd>
      <p>These are used for getting or setting <a href="http://www.sqlite.org/c3ref/limit.html">run-time limits</a></p>
    </dd>

    <dt><a href="http://sqlite.org/c3ref/c_config_getmalloc.html"><strong>SQLITE_CONFIG_SINGLETHREAD,
    SQLITE_CONFIG_MULTITHREAD</strong> and 9 others</a></dt>

    <dd>
      <p>These are used with <a href="http://sqlite.org/c3ref/config.html">sqlite3_config</a>. Mapping is
      <code>apsw.mapping_config</code></p>
    </dd>

    <dt><a href="http://sqlite.org/c3ref/c_status_malloc_size.html"><strong>SQLITE_STATUS_MEMORY_USED,
    SQLITE_STATUS_PAGECACHE_USED</strong> and 4 others</a></dt>

    <dd>
      <p>These are used with <a href="http://sqlite.org/c3ref/status.html">sqlite3_status</a>. Mapping is
      <code>apsw.mapping_status</code></p>
    </dd>

    <dt><a href="http://sqlite.org/c3ref/c_lock_exclusive.html"><strong>SQLITE_LOCK_NONE, SQLITE_LOCK_SHARED</strong>
    and 3 others</a></dt>

    <dd>
      <p>These are used with the <a href="http://sqlite.org/c3ref/io_methods.html">xLock/xUnlock</a> VFS file methods.
      Mapping is <code>apsw.mapping_locking_level</code></p>
    </dd>

    <dt><a href="http://sqlite.org/c3ref/c_iocap_atomic.html"><strong>SQLITE_IOCAP_ATOMIC, SQLITE_IOCAP_ATOMIC512,
    SQLITE_IOCAP_ATOMIC1K</strong> and 8 others</a></dt>

    <dd>
      <p>These are used with the <a href="http://sqlite.org/c3ref/io_methods.html">xDeviceCharacteristics</a> VFS file
      method. Mapping is <code>apsw.mapping_device_characteristics</code></p>
    </dd>

    <dt><a href="http://sqlite.org/c3ref/c_sync_dataonly.html"><strong>SQLITE_SYNC_NORMAL, SQLITE_SYNC_FULL</strong>
    and 1 other</a></dt>

    <dd>
      <p>These are used with the <a href="http://sqlite.org/c3ref/io_methods.html">xSync</a> VFS file method. Mapping
      is <code>apsw.mapping_sync</code></p>
    </dd>

    <dt><a href="http://sqlite.org/c3ref/c_access_exists.html"><strong>SQLITE_ACCESS_EXISTS, SQLITE_ACCESS_READWRITE,
    SQLITE_ACCESS_READ</strong></a></dt>

    <dd>
      <p>These are used with the xAccess <a href="http://sqlite.org/c3ref/vfs.html">VFS method</a>. Mapping is
      <code>apsw.mapping_access</code>.</p>
    </dd>
  </dl>

  <h2><a name="Connection_class" id="Connection_class">Connection class</a></h2>

  <p>The connection class wraps a <code>sqlite3 pointer</code>.</p>

  <dl>
    <dt><strong>Connection(filename, flags=SQLITE_OPEN_READWRITE|SQLITE_OPEN_CREATE, vfs=None,
    statementcachesize=100)</strong></dt>

    <dd>
      <p>Opens an SQLite database named <code>filename</code>. (This calls <a href=
      "http://sqlite.org/c3ref/open.html">sqlite3_open_v2</a> behind the scenes.) If you don't supply a vfs then the
      default will be used. You can also set how many entries there are in the statement cache. You will generally want
      this to be the total number of distinct SQL statements you execute frequently.</p>
    </dd>

    <dt><strong>close(force=False)</strong></dt>

    <dd>
      <p>You may call this method when you are done with a Connection. Behind the scenes it calls <a href=
      "http://sqlite.org/c3ref/close.html">sqlite3_close</a>. It is ok to call this method multiple times. Note that
      this method can raise an exception. Some examples of when exceptions are raised:</p>

      <ul>
        <li>You have statements still executing (ie currently positioned at a row, with more statements to execute).
        Statements that have consumed all results will not hold up closing a Connection.</li>

        <li>You were in the middle of a transaction. SQLite will attempt to do a rollback and errors in your rollback
        hook will be passed back.</li>

        <li>Any virtual tables will be dropped/disconnected. Errors in your Disconnect/Destroy methods will be passed
        back.</li>
      </ul>

      <p>If <tt>force</tt> is True, then any executing cursors are forcibly closed.</p>
    </dd>

    <dt><strong>cursor()</strong></dt>

    <dd>
      <p>Creates a new <a href="#Cursor">cursor</a> object on this database.</p>
    </dd>

    <dt><strong>changes()</strong></dt>

    <dd>
      <p>This function returns the number of database rows that were changed (or inserted or deleted) by the most
      recently completed INSERT, UPDATE, or DELETE statement. (This calls <a href=
      "http://sqlite.org/c3ref/changes.html">sqlite3_changes</a>. Read that link for some additional notes.)</p>
    </dd>

    <dt><strong>totalchanges()</strong></dt>

    <dd>
      <p>This function returns the total number of database rows that have be modified, inserted, or deleted since the
      database connection was opened. (This calls <a href=
      "http://sqlite.org/c3ref/total_changes.html">sqlite3_total_changes</a>. Read that link for some additional
      notes.)</p>
    </dd>

    <dt><strong>last_insert_rowid()</strong></dt>

    <dd>
      <p>Returns the integer key of the most recent insert in the database. (This calls <a href=
      "http://sqlite.org/c3ref/last_insert_rowid.html">sqlite3_last_insert_rowid</a>.)</p>
    </dd>

    <dt><strong>complete(statement)</strong></dt>

    <dd>
      <p>Calls <a href="http://sqlite.org/c3ref/complete.html">sqlite3_complete</a> which tells you if the input string
      comprises one or more complete SQL statements.</p>
    </dd>

    <dt><strong>setbusytimeout(milliseconds)</strong></dt>

    <dd>
      <p>Sets the busy timeout. (This calls <a href=
      "http://sqlite.org/c3ref/busy_timeout.html">sqlite3_busy_timeout</a>).</p>
    </dd>

    <dt><strong>setbusyhandler(callable)</strong></dt>

    <dd>
      <p>Sets the busy handler to callable. callable will be called with one integer argument which is the number of
      prior calls to the busy callback for the same lock. If the busy callback returns something that evaluates to
      False, then SQLite returns SQLITE_BUSY to the calling code.. If the callback returns something that evaluates to
      True, then SQLite tries to open the table again and the cycle repeats. (This calls <a href=
      "http://sqlite.org/c3ref/busy_handler.html">sqlite3_busy_handler</a>).</p>
    </dd>

    <dt><strong>interrupt()</strong></dt>

    <dd>
      <p>Causes any pending operations on the database to abort at the earliest opportunity. You can call this from any
      thread. (This calls <a href="http://sqlite.org/c3ref/interrupt.html">sqlite3_interrupt</a>).</p>
    </dd>

    <dt><a name="Connection_limit" id="Connection_limit"><strong>limit(id [, newval])</strong></a></dt>

    <dd>
      <p>If called with one parameter then the relevant limit is returned. If called with two then the limit is
      changed. Returns the old value of the limit. This calls <a href=
      "http://www.sqlite.org/c3ref/limit.html">sqlite3_limit</a>. For example
      <code>connection.limit(apsw.SQLITE_LIMIT_LENGTH, 1024)</code> would set the limit for blobs and strings to 1
      kilobyte. To find the maximum value, set the limit to 0x7fffffff and then call <tt>connection.limit</tt> again to
      see what value it was set to.</p>
    </dd>

    <dt><strong>createscalarfunction(name, callable, numargs=-1)</strong></dt>

    <dd>
      <p>Registers a scalar function. The callable will be called. You can specify how many arguments your function
      takes as the numargs parameter or supply -1 to take any amount. (This calls <a href=
      "http://sqlite.org/c3ref/create_function.html">sqlite3_create_function</a>).</p>
    </dd>

    <dt><strong>createaggregatefunction(name, factorycallback, numargs=-1)</strong></dt>

    <dd>
      <p>Registers an aggregate function. (This calls <a href=
      "http://sqlite.org/c3ref/create_function.html">sqlite3_create_function</a>.) You can specify how many arguments
      your function takes as the numargs parameter or supply -1 to take any amount. When the function is called by an
      SQL query, the factorycallback is called without any arguments. The factorycallback needs to return a tuple
      consisting of three 3 items.</p>

      <ul>
        <li>
          <p>a context object (of any type)</p>
        </li>

        <li>
          <p>a step function which is called for each row. The context object will be the first parameter, and the
          remaining parameters will be from the SQL statement. The return value is ignored - you supply it in
          final.</p>
        </li>

        <li>
          <p>a final function which is called at the end. The only parameter will be the context object. The value
          returned is set as the return for the function. It must be a valid SQLite type. Note that the final function
          is always called even if an exception was raised by the step function. This allows you to ensure any
          resources are cleaned up.</p>
        </li>
      </ul>
    </dd>

    <dt><strong>createcollation(name, callable)</strong></dt>

    <dd>
      <p>Creates a collation with the specified name and callable. The callable will be passed two string arguments. It
      should return -1 if the first is less than the second, 0 if they are equal and 1 and if the first is greater than
      the second. Note that this controls sorting (ORDER BY in SQL) so your comparisons don't affect other SQL
      operations. Read more about <a href="http://www.sqlite.org/datatype3.html#collation">SQLite's handling of
      collations.</a> (This calls <a href=
      "http://sqlite.org/c3ref/create_collation.html">sqlite3_create_collation</a>.) If there is an error in your
      Python code then 0 (ie items are equal) is returned.</p>
    </dd>

    <dt><strong>collationneeded(callable)</strong></dt>

    <dd>
      <p><tt>callable</tt> will be called if a statement requires a collation that hasn't been registered. Your
      callable will be passed two parameters. The first is the connection object. The second is the name of the
      collation. If you have the collation code available then call createcollation, else just return.</p>
    </dd>

    <dt><strong>setauthorizer(callable)</strong></dt>

    <dd>
      <p>The callable is invoked while SQL statements are being prepared. The intent is to allow applications to safely
      execute user entered SQL. The callable is called with 5 parameters:</p>

      <ul>
        <li>
          <p>an integer representing the operation (the constants are available on the apsw module - eg
          <code>apsw.SQLITE_CREATE_TABLE</code>.</p>
        </li>

        <li>
          <p>A string (or None) dependent on the operation</p>
        </li>

        <li>
          <p>Another string (or None) dependent on the operation</p>
        </li>

        <li>
          <p>The string name of the database (or None)</p>
        </li>

        <li>
          <p>Name of the innermost trigger or view doing the access (or None)</p>
        </li>
      </ul>

      <p>You should return <code>apsw.SQLITE_OK</code> to allow the operation or <code>apsw.SQLITE_DENY</code> or
      <code>apsw.SQLITE_IGNORE</code> as applicable. (SQLITE_DENY is returned if there is an error in your Python
      code).</p>

      <p>This calls <a href="http://sqlite.org/c3ref/set_authorizer.html">sqlite3_set_authorizer</a> which contains
      more detailed documentation.</p>
    </dd>

    <dt><strong>setupdatehook(callable)</strong></dt>

    <dd>
      <p>Sets a callable which is invoked during data changing. The callable takes four parameters:</p>

      <ul>
        <li>An integer whose value is one of apsw.SQLITE_INSERT, apsw.SQLITE_DELETE or apsw.SQLITE_UPDATE</li>

        <li>A string naming the database on which the operation is happening. (This will typically be <tt>main</tt>
        unless you used <a href="http://sqlite.org/lang_attach.html"><tt>ATTACH</tt></a></li>

        <li>A string naming the table on which the operation is happening.</li>

        <li>An integer with the rowid of the row that is changing.</li>
      </ul>

      <p>(This calls <a href="http://sqlite.org/c3ref/update_hook.html">sqlite3_update_hook</a>.)</p>
    </dd>

    <dt><strong>setrollbackhook(callable)</strong></dt>

    <dd>
      <p>Sets a callable which is invoked during a rollback. The callable takes no parameters and the return value is
      ignored. (This calls <a href="http://sqlite.org/c3ref/commit_hook.html">sqlite3_rollback_hook</a>.)</p>
    </dd>

    <dt><strong>setcommithook(callable)</strong> (SQLite 3 experimental feature)</dt>

    <dd>
      <p>Sets a callable which is invoked just before a commit. It should return zero for the commit to go ahead and
      non-zero for it to be turned into a rollback. In the case of an exception in your callable, a non-zero (ie
      rollback) value is returned. (This calls <a href=
      "http://sqlite.org/c3ref/commit_hook.html">sqlite3_commit_hook</a>.)</p>
    </dd>

    <dt><strong>setprofile(callable)</strong> (SQLite 3 experimental feature)</dt>

    <dd>
      <p>Sets a callable which is invoked at the end of execution of each statement and passed the statement string and
      how long it took to execute. (The execution time appears to be in nanoseconds.) Note that it is called only on
      completion. If for example you do a <tt>SELECT</tt> and only read the first result, then you won't reach the end
      of the statement.</p>

      <p>(This calls <tt>sqlite3_profile</tt> which is not documented on the SQLite web site. See the
      <tt>sqlite3.h</tt> header file for documentation.).</p>
    </dd>

    <dt><strong>setprogresshandler(callable, nsteps=20)</strong> (SQLite 3 experimental feature)</dt>

    <dd>
      <p>Sets a callable which is invoked every <i>nsteps</i> SQLite inststructions. The callable should return a
      non-zero value to abort or zero to continue. (If there is an error in your Python callable then non-zero will be
      returned). (This calls <a href="http://sqlite.org/c3ref/progress_handler.html">sqlite3_progress_handler</a> which
      has more detailed documentation).</p>
    </dd>

    <dt><strong>enableloadextension(bool)</strong> (SQLite 3 experimental feature)</dt>

    <dd>
      <p>Enables <a href="http://www.sqlite.org/cvstrac/wiki/wiki?p=LoadableExtensions">extension</a> loading which is
      disabled by default. Calls sqlite3_enable_load_extension. See note below about enabling extension loading.</p>
    </dd>

    <dt><strong>loadextension(filename, entrypoint=None)</strong> (SQLite 3 experimental feature)</dt>

    <dd>
      <p>Loads an <a href="http://www.sqlite.org/cvstrac/wiki/wiki?p=LoadableExtensions">extension</a> by calling
      sqlite3_load_extension. If you don't specify the entrypoint then SQLite uses a default of
      sqlite3_extension_init.</p>

      <p>Note that if you build SQLite on Unix then extension loading won't be built into SQLite by default. The
      details are in SQLite ticket <a href="http://www.sqlite.org/cvstrac/tktview?tn=2082">2082</a>. You need to edit
      <tt>setup.py</tt> if you enable extension loading.</p>
    </dd>

    <dt><strong><a name="filecontrol" id="filecontrol">filecontrol(op, pointer)</a></strong></dt>

    <dd>
      <p>Calls <a href="http://sqlite.org/c3ref/file_control.html">sqlite3_file_control</a>. <i>op</i> should be a
      number with values below 100 reserved by SQLite. This is an example if how to pass a Python object using <a href=
      "http://docs.python.org/lib/module-ctypes.html">ctypes</a>.</p>
      <pre>
obj={"foo": 1, 2: 3}                 # object we want to pass
objwrap=ctypes.py_object(obj)        # objwrap must live before and after the call else
                                     # it gets garbage collected
connection.filecontrol(
         123,                        # our op code
         ctypes.addressof(objwrap))  # get pointer
</pre>

      <p>In your VFS file implementation, you turn the pointer back into a Python object like this:</p>
      <pre>
def xFileControl(self, op, pointer):
    if op==123:                      # our op code
        obj=ctypes.py_object.from_address(pointer).value
        # play with obj - you can use id() to verify it is the same
        print obj["foo"]
        obj["result"]="it worked"
    else:
        raise Exception("Unknown file control "+`op`)
</pre>
    </dd>

    <dt><strong>sqlite3pointer()</strong></dt>

    <dd>
      <p>Returns the underlying <a href="http://sqlite.org/c3ref/sqlite3.html">sqlite3</a> pointer for the connection.
      This method is useful if there are other C level libraries in the same process and you want them to use the APSW
      connection handle. The value is returned as a number using <a href=
      "http://docs.python.org/c-api/long.html?highlight=pylong_fromvoidptr#PyLong_FromVoidPtr">PyLong_FromVoidPtr</a>
      under the hood. You should also ensure that you hang on to the Connection object for as long as the other
      libraries are using the handle or increment the reference count on it. It is also a very good idea to call
      <tt>apsw.sqlitelibversion()</tt> and ensure it is the same as the other libraries.</p>
    </dd>

    <dt><strong>blobopen(databasename, tablename, columnname, rowid, flags)</strong></dt>

    <dd>
      <p>Returns a new <a href="#blobio">blob</a>. The database name will be <tt>main</tt>, unless you want to refer to
      a database you <a href="http://www.sqlite.org/lang_attach.html">ATTACH</a>ed.</p>
    </dd>
  </dl>

  <h2><a name="blobio" id="blobio">Blob I/O</a></h2>

  <p>Historically SQLite only let you access and create blobs in their entirity. For example to reading or writing a
  single byte from a blob required reading or writing the whole blob.</p>

  <p>SQLite now provides incremental blob access, with APSW exposing it as a file like object. Call Connection.blobopen
  to open a blob. <b>Note</b> that the underlying <a href="http://www.sqlite.org/c3ref/blob.html">SQLite blob apis</a>
  require offsets to be provided to each call, but the APSW blob object tracks that for you.</p>

  <dl>
    <dt><strong>close(force=False)</strong></dt>

    <dd>
      <p>Stops any further access to the blob. You should proactively call close as it will return errors that may
      correspond to earlier blob i/o. See <a href="http://www.sqlite.org/c3ref/blob_close.html">blob_close()</a> for
      more details. If you call any of the other methods on a closed blob then you will get a ValueError exception
      (this is the same as calling methods on a closed Python file object).</p>

      <p><i>force</i> currently has no effect and is present for compatibility with cursor objects.</p>
    </dd>

    <dt><strong>read([amount])</strong></dt>

    <dd>Reads amount of data requested, or till end of file, whichever is earlier. Attempting to read beyond the end of
    the blob returns the empty string, in the same manner as end of file on normal file objects.</dd>

    <dt><strong>write(data)</strong></dt>

    <dd>Writes the requested data. Note that you cannot make the blob larger or smaller. Normally you would create a
    zeroblob and then come back and fill it in with this method, as shown in the <a href=
    "#example-blobio">example</a>.</dd>

    <dt><strong>tell()</strong></dt>

    <dd>Returns the current position.</dd>

    <dt><strong>seek(offset, [whence])</strong></dt>

    <dd>Change the current position. If whence is omitted or zero, then the position is set to offset. If whence is 1
    then offset is added to the current position. If whence is 2 then offset is relative to the end of the blob.</dd>
  </dl>

  <h2><a name="Cursor" id="Cursor">Cursor class</a></h2>

  <p>The Cursor class creates and executes SQLite prepared statements.</p>

  <dl>
    <dt><strong>Cursor()</strong></dt>

    <dd>
      <p>You cannot create cursors directly. The are created by calling Connection.cursor().</p>
    </dd>

    <dt><strong>close(force=False)</strong></dt>

    <dd>
      <p>In general cursors are in a closed state, and you won't need to call this method. Calling while the cursor is
      already closed or if the Connection is closed will not result in errors. An open Cursor prevents closing of
      Connections. The circumstances in which they are not closed include:</p>

      <ul>
        <li>You haven't requested all the rows of available data (calling next() or using the cursor as an iterator
        will return more data)</li>

        <li>You got a recoverable error and can try again (eg SQLITE_BUDY)</li>

        <li>If force is False then you will get exceptions if there is remaining work to do be in the Cursor such as
        more statements to execute, more data from the executemany binding sequence etc. If force is True then all
        remaining work and state information will be discarded.</li>
      </ul>
    </dd>

    <dt><strong>getconnection()</strong></dt>

    <dd>
      <p>Returns the <a href="#Connection">Connection</a> object to which this cursor belongs.</p>
    </dd>

    <dt><strong>execute(statements, bindings=())</strong></dt>

    <dd>
      <p>Executes the statements using the supplied bindings. The bindings can be supplied as a tuple or as a dict.
      Execution returns when the first row is available or all statements have completed. The cursor object is returned
      which you can use as an iterator. (See <a href="#executionmodel">execution model</a> for more details. This
      function wraps <a href="http://sqlite.org/c3ref/prepare.html">sqlite3_prepare_v2</a> and <a href=
      "http://sqlite.org/c3ref/step.html">sqlite3_step</a>.)</p>
    </dd>

    <dt><strong>executemany(statements, sequenceofbindings=())</strong></dt>

    <dd>
      <p>Repeatedly executes statements using each element of sequenceofbindings for the bindings each time. Execution
      returns when the first row is available or all statements have completed. The cursor object is returned which you
      can use as an iterator. (See <a href="#executionmodel">execution model</a> for more details. This function runs
      in a loop on each member of sequenceofbindings and wraps <a href=
      "http://sqlite.org/c3ref/prepare.html">sqlite3_prepare_v2</a> and <a href=
      "http://sqlite.org/c3ref/step.html">sqlite3_step</a>.)</p>
    </dd>

    <dt><strong>next()</strong></dt>

    <dd>
      <p>The Cursor object is an iterator, and so you can use it in a for loop or similar situations. You can also
      explicitly call the <code>next()</code> method. This method returns a tuple of the contents of a returned row or
      raises StopIteration after all returned rows have been seen.</p>
    </dd>

    <dt><strong>getdescription()</strong></dt>

    <dd>
      <p>Returns a list describing each column in the current result set. Each item is a tuple of (column name,
      declared column type). You should only call this function while data is being returned such as when
      <code>next()</code> returns a row. This function calls <a href=
      "http://sqlite.org/c3ref/column_name.html">sqlite3_column_name</a> and <a href=
      "http://sqlite.org/c3ref/column_decltype.html">sqlite3_column_decltype</a>.</p>
    </dd>

    <dt><strong>setexectrace(callable)</strong><br />
    <strong>setrowtrace(callable)</strong><br />
    <strong>getexectrace()</strong><br />
    <strong>getrowtrace()</strong></dt>

    <dd>
      <p>Sets or gets the <a href="#tracers">tracers</a>.</p>
    </dd>
  </dl>





</body>
</html>
